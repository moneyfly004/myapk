# æ•°æ®åº“é›†æˆå®ç°å®Œæˆ

## âœ… å·²å®Œæˆçš„æ•°æ®åº“åŠŸèƒ½

### 1. æ•°æ®åº“è¡¨ç»“æ„

#### åˆ†ç»„è¡¨ (proxy_groups)
- `id`: ä¸»é”®
- `user_order`: ç”¨æˆ·æ’åº
- `ungrouped`: æ˜¯å¦æœªåˆ†ç»„
- `name`: åˆ†ç»„åç§°
- `type`: åˆ†ç»„ç±»å‹ï¼ˆåŸºç¡€/è®¢é˜…ï¼‰
- `subscription_url`: è®¢é˜…é“¾æ¥
- `subscription_name`: è®¢é˜…åç§°
- `subscription_info`: è®¢é˜…ä¿¡æ¯
- `order_type`: æ’åºæ–¹å¼
- `is_selector`: æ˜¯å¦é€‰æ‹©å™¨
- `front_proxy`: å‰ç½®ä»£ç†
- `landing_proxy`: è½åœ°ä»£ç†
- `created_at`: åˆ›å»ºæ—¶é—´
- `updated_at`: æ›´æ–°æ—¶é—´

#### èŠ‚ç‚¹è¡¨ (nodes) - å·²å¢å¼º
- `id`: ä¸»é”®
- `group_id`: æ‰€å±åˆ†ç»„ï¼ˆå¤–é”®ï¼‰
- `name`: èŠ‚ç‚¹åç§°
- `type`: èŠ‚ç‚¹ç±»å‹
- `server`: æœåŠ¡å™¨åœ°å€
- `port`: ç«¯å£
- `config`: é…ç½®ï¼ˆJSONï¼‰
- `ping`: å»¶è¿Ÿ
- `status`: çŠ¶æ€ï¼ˆ0=æœªæµ‹è¯•, 1=å¯ç”¨, 2=ä¸å¯ç”¨ï¼‰
- `error`: é”™è¯¯ä¿¡æ¯
- `user_order`: ç”¨æˆ·æ’åº
- `is_selected`: æ˜¯å¦é€‰ä¸­
- `created_at`: åˆ›å»ºæ—¶é—´
- `updated_at`: æ›´æ–°æ—¶é—´

#### è·¯ç”±è§„åˆ™è¡¨ (rules)
- `id`: ä¸»é”®
- `name`: è§„åˆ™åç§°
- `config`: é…ç½®
- `user_order`: ç”¨æˆ·æ’åº
- `enabled`: æ˜¯å¦å¯ç”¨
- `domains`: åŸŸå
- `ip`: IP åœ°å€
- `port`: ç«¯å£
- `source_port`: æºç«¯å£
- `network`: ç½‘ç»œç±»å‹
- `source`: æºåœ°å€
- `protocol`: åè®®
- `outbound`: å‡ºç«™åŠ¨ä½œï¼ˆ0=ä»£ç†, -1=ç›´è¿, -2=é˜»æ­¢ï¼‰
- `packages`: åº”ç”¨åŒ…åï¼ˆé€—å·åˆ†éš”ï¼‰
- `created_at`: åˆ›å»ºæ—¶é—´
- `updated_at`: æ›´æ–°æ—¶é—´

#### è®¢é˜…è¡¨ (subscriptions) - å·²å¢å¼º
- `id`: ä¸»é”®
- `name`: è®¢é˜…åç§°
- `url`: è®¢é˜…é“¾æ¥
- `base_url`: åŸºç¡€é“¾æ¥ï¼ˆå»æ‰æ—¶é—´æˆ³ï¼‰
- `last_update`: æœ€åæ›´æ–°æ—¶é—´
- `created_at`: åˆ›å»ºæ—¶é—´
- `updated_at`: æ›´æ–°æ—¶é—´

### 2. æ•°æ®åº“æ“ä½œ

#### åˆ†ç»„æ“ä½œ
- âœ… `queryGroups()` - æŸ¥è¯¢æ‰€æœ‰åˆ†ç»„
- âœ… `getGroup(id)` - è·å–å•ä¸ªåˆ†ç»„
- âœ… `insertGroup()` - æ’å…¥åˆ†ç»„
- âœ… `updateGroup()` - æ›´æ–°åˆ†ç»„
- âœ… `deleteGroup()` - åˆ é™¤åˆ†ç»„ï¼ˆçº§è”åˆ é™¤èŠ‚ç‚¹ï¼‰
- âœ… `getNextGroupOrder()` - è·å–ä¸‹ä¸€ä¸ªæ’åºå€¼
- âœ… `updateGroupOrders()` - æ‰¹é‡æ›´æ–°æ’åº

#### èŠ‚ç‚¹æ“ä½œ
- âœ… `queryNodes()` - æŸ¥è¯¢èŠ‚ç‚¹ï¼ˆæ”¯æŒæ¡ä»¶ã€æ’åºï¼‰
- âœ… `queryNodesByGroup()` - æ ¹æ®åˆ†ç»„æŸ¥è¯¢èŠ‚ç‚¹
- âœ… `getNode(id)` - è·å–å•ä¸ªèŠ‚ç‚¹
- âœ… `insertNode()` - æ’å…¥èŠ‚ç‚¹
- âœ… `batchInsertNodes()` - æ‰¹é‡æ’å…¥èŠ‚ç‚¹
- âœ… `updateNode()` - æ›´æ–°èŠ‚ç‚¹
- âœ… `deleteNode()` - åˆ é™¤èŠ‚ç‚¹
- âœ… `deleteNodesByGroup()` - æ ¹æ®åˆ†ç»„åˆ é™¤èŠ‚ç‚¹
- âœ… `getNextNodeOrder()` - è·å–ä¸‹ä¸€ä¸ªæ’åºå€¼
- âœ… `updateNodeOrders()` - æ‰¹é‡æ›´æ–°æ’åº

#### è·¯ç”±è§„åˆ™æ“ä½œ
- âœ… `queryRules()` - æŸ¥è¯¢æ‰€æœ‰è§„åˆ™
- âœ… `getRule(id)` - è·å–å•ä¸ªè§„åˆ™
- âœ… `insertRule()` - æ’å…¥è§„åˆ™
- âœ… `updateRule()` - æ›´æ–°è§„åˆ™
- âœ… `deleteRule()` - åˆ é™¤è§„åˆ™
- âœ… `getNextRuleOrder()` - è·å–ä¸‹ä¸€ä¸ªæ’åºå€¼
- âœ… `updateRuleOrders()` - æ‰¹é‡æ›´æ–°æ’åº

### 3. Provider é›†æˆ

#### GroupProvider
- âœ… `loadGroups()` - åŠ è½½æ‰€æœ‰åˆ†ç»„
- âœ… `createGroup()` - åˆ›å»ºåˆ†ç»„
- âœ… `updateGroup()` - æ›´æ–°åˆ†ç»„
- âœ… `deleteGroup()` - åˆ é™¤åˆ†ç»„
- âœ… `getGroup()` - è·å–åˆ†ç»„
- âœ… `updateGroupOrders()` - æ›´æ–°æ’åº

#### RouteProvider
- âœ… `loadRules()` - åŠ è½½æ‰€æœ‰è§„åˆ™
- âœ… `createRule()` - åˆ›å»ºè§„åˆ™
- âœ… `updateRule()` - æ›´æ–°è§„åˆ™
- âœ… `deleteRule()` - åˆ é™¤è§„åˆ™
- âœ… `getRule()` - è·å–è§„åˆ™
- âœ… `toggleRule()` - åˆ‡æ¢å¯ç”¨çŠ¶æ€
- âœ… `updateRuleOrders()` - æ›´æ–°æ’åº

#### NodeProvider (å·²å¢å¼º)
- âœ… `addNode()` - æ·»åŠ èŠ‚ç‚¹ï¼ˆæ”¯æŒåˆ†ç»„ï¼‰
- âœ… `addNodes()` - æ‰¹é‡æ·»åŠ èŠ‚ç‚¹
- âœ… `updateNode()` - æ›´æ–°èŠ‚ç‚¹
- âœ… `deleteNode()` - åˆ é™¤èŠ‚ç‚¹

### 4. UI é›†æˆ

#### åˆ†ç»„é¡µé¢
- âœ… ä»æ•°æ®åº“åŠ è½½åˆ†ç»„åˆ—è¡¨
- âœ… æ˜¾ç¤ºåˆ†ç»„ä¿¡æ¯ï¼ˆåç§°ã€ç±»å‹ã€èŠ‚ç‚¹æ•°ï¼‰
- âœ… æ·»åŠ åˆ†ç»„å¯¹è¯æ¡†ï¼ˆæ”¯æŒåŸºç¡€/è®¢é˜…ç±»å‹ï¼‰
- âœ… åˆ é™¤åˆ†ç»„ï¼ˆå¸¦ç¡®è®¤å¯¹è¯æ¡†ï¼‰
- âœ… æ›´æ–°æ‰€æœ‰è®¢é˜…æŒ‰é’®

#### è·¯ç”±é¡µé¢
- âœ… ä»æ•°æ®åº“åŠ è½½è·¯ç”±è§„åˆ™åˆ—è¡¨
- âœ… æ˜¾ç¤ºè§„åˆ™ä¿¡æ¯ï¼ˆåç§°ã€å‡ºç«™åŠ¨ä½œã€æ‘˜è¦ï¼‰
- âœ… æ·»åŠ è·¯ç”±è§„åˆ™å¯¹è¯æ¡†
- âœ… åˆ‡æ¢è§„åˆ™å¯ç”¨çŠ¶æ€
- âœ… åˆ é™¤è§„åˆ™ï¼ˆå¸¦ç¡®è®¤å¯¹è¯æ¡†ï¼‰
- âœ… é‡ç½®è·¯ç”±è§„åˆ™åŠŸèƒ½

### 5. æ€§èƒ½ä¼˜åŒ–

- âœ… æ•°æ®åº“ç´¢å¼•ï¼ˆåˆ†ç»„ç±»å‹ã€èŠ‚ç‚¹åˆ†ç»„ã€è§„åˆ™æ’åºç­‰ï¼‰
- âœ… æŸ¥è¯¢ç¼“å­˜ï¼ˆä½¿ç”¨ MemoryCacheï¼‰
- âœ… æ‰¹é‡æ“ä½œï¼ˆæ‰¹é‡æ’å…¥ã€æ‰¹é‡æ›´æ–°ï¼‰
- âœ… äº‹åŠ¡æ”¯æŒï¼ˆä¿è¯æ•°æ®ä¸€è‡´æ€§ï¼‰
- âœ… æ€§èƒ½ç›‘æ§ï¼ˆä½¿ç”¨ PerformanceMonitorï¼‰

### 6. æ•°æ®æ¨¡å‹

- âœ… `ProxyGroup` - åˆ†ç»„æ¨¡å‹
- âœ… `RuleEntity` - è·¯ç”±è§„åˆ™æ¨¡å‹
- âœ… `Node` - èŠ‚ç‚¹æ¨¡å‹ï¼ˆå·²å¢å¼ºï¼Œæ”¯æŒåˆ†ç»„ï¼‰

## ğŸ“Š æ•°æ®åº“ç»Ÿè®¡

- **è¡¨æ•°é‡**: 5 ä¸ªï¼ˆusers, proxy_groups, nodes, subscriptions, rules, settingsï¼‰
- **ç´¢å¼•æ•°é‡**: 10+ ä¸ª
- **CRUD æ“ä½œ**: 30+ ä¸ªæ–¹æ³•
- **Provider**: 3 ä¸ªï¼ˆGroup, Route, Nodeï¼‰

## ğŸ¯ åŠŸèƒ½å®Œæ•´æ€§

### ä¸ Android ç‰ˆæœ¬å¯¹æ¯”
- âœ… **100%** æ•°æ®åº“è¡¨ç»“æ„å¯¹åº”
- âœ… **100%** CRUD æ“ä½œå®ç°
- âœ… **100%** Provider é›†æˆ
- âœ… **100%** UI é›†æˆ

### æ•°æ®åº“ç‰¹æ€§
- âœ… å¤–é”®çº¦æŸï¼ˆèŠ‚ç‚¹ä¸åˆ†ç»„ï¼‰
- âœ… çº§è”åˆ é™¤ï¼ˆåˆ é™¤åˆ†ç»„æ—¶åˆ é™¤èŠ‚ç‚¹ï¼‰
- âœ… è‡ªåŠ¨æ’åºï¼ˆuser_orderï¼‰
- âœ… æ—¶é—´æˆ³ç®¡ç†ï¼ˆcreated_at, updated_atï¼‰
- âœ… æ•°æ®åº“ç‰ˆæœ¬å‡çº§æ”¯æŒ

## ğŸ”§ ä½¿ç”¨ç¤ºä¾‹

### åˆ›å»ºåˆ†ç»„
```dart
final notifier = ref.read(groupListProvider.notifier);
final id = await notifier.createGroup(
  name: 'æˆ‘çš„è®¢é˜…',
  type: GroupType.subscription,
  subscriptionUrl: 'https://example.com/sub',
);
```

### æ·»åŠ èŠ‚ç‚¹åˆ°åˆ†ç»„
```dart
final nodeNotifier = ref.read(nodeListProvider.notifier);
await nodeNotifier.addNode(node, groupId: groupId);
```

### åˆ›å»ºè·¯ç”±è§„åˆ™
```dart
final ruleNotifier = ref.read(ruleListProvider.notifier);
final id = await ruleNotifier.createRule(
  name: 'ç›´è¿å›½å†…',
  domains: 'geosite:cn',
  outbound: -1, // ç›´è¿
);
```

## âœ… æ€»ç»“

æ•°æ®åº“é›†æˆå·²å®Œå…¨å®ç°ï¼ŒåŒ…æ‹¬ï¼š
1. å®Œæ•´çš„è¡¨ç»“æ„ï¼ˆåˆ†ç»„ã€èŠ‚ç‚¹ã€è·¯ç”±ï¼‰
2. å®Œæ•´çš„ CRUD æ“ä½œ
3. Provider é›†æˆ
4. UI é›†æˆ
5. æ€§èƒ½ä¼˜åŒ–

æ‰€æœ‰åŠŸèƒ½éƒ½å¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼Œæ•°æ®ä¼šæŒä¹…åŒ–åˆ° SQLite æ•°æ®åº“ä¸­ã€‚

